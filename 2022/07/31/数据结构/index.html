<!DOCTYPE html>
<html lang="zh-CN">
<head>
  
  <!--å°†è¯¥ä»£ç æ”¾å…¥åšå®¢æ¨¡æ¿çš„headä¸­å³å¯-->
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  tex2jax: {
  inlineMath: [['$','$'], ['\\(','\\)']],
  processEscapes: true
  }
  });
  </script>
  <!--latexæ•°å­¦æ˜¾ç¤ºå…¬å¼-->
  <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#3367D6"/>
  <link rel="apple-touch-icon" href="/icons-192.png">
  <link rel="manifest" href="/manifest.json">
  
  <meta name="generator" content="Hexo 6.2.0">

  

  

  
    <meta name="author" content="Ztemily">
  

  

  

  <title>æ•°æ®ç»“æ„ | æœªå†³å¤©</title>

  

  
    <link rel="shortcut icon" href="/favicon.ico">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@1.1.3/index.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/monokai.css">
  

  
<link rel="stylesheet" href="/css/style.css">

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --></head>
<body>
  <div class="root-container">
    
<!-- header container -->
<header class="header-container post">
  
    <div class="post-image" style="background-image: url(https://s1.328888.xyz/2022/06/09/CJSfd.jpg)"></div>
  

  <!-- navbar -->
<nav class="navbar">
  <div class="navbar-content">
    <!-- logo -->
    <div class="navbar-logo">
      <a href="/">
        
          æœªå†³å¤©
        
      </a>
    </div>
    <!-- link -->
    <div class="navbar-link">
      <div class="navbar-btn">
        <div></div>
        <div></div>
        <div></div>
      </div>
      <ul class="navbar-list">
        
          <li class="navbar-list-item"><a href="/">é¦–é¡µ</a></li>
        
          <li class="navbar-list-item"><a href="/links">å‹é“¾</a></li>
        
          <li class="navbar-list-item"><a href="/about">å…³äº</a></li>
        
      </ul>
    </div>
  </div>
</nav>

  
  

  
  

  
  

  
  

  
  
    <div class="header-content">
      <div class="post-text layout-block">
        <div class="layout-margin">
          <h1 class="title-wrap">æ•°æ®ç»“æ„</h1>
          <h2 class="title-sub-wrap">
            <strong>Ztemily</strong>
            <span>å‘å¸ƒäº</span>
            <time  class="article-date" datetime="2022-07-30T22:59:55.000Z" itemprop="datePublished">2022-07-31</time>
          </h2>
          <ul class="wrap-list dark">
  
</ul>
          <ul class="wrap-list dark">
  
    <li><a href="/tags/OI/">ğŸ·ï¸ OI</a></li>
  
</ul>
        </div>
      </div>
    </div>
  

  
  
  
</header>

    <!-- æ–‡ç«  -->

<!-- æ–‡ç« å†…å®¹ -->
<div class="body-container">
  <article class="content-container layout-block post-container">
    <div class="article-info">
      
      
      
      
      <section class="article-entry markdown-body layout-margin content-padding--large soft-size--large soft-style--box">
        <h1 id="å¹³è¡¡æ ‘"><a class="markdownIt-Anchor" href="#å¹³è¡¡æ ‘"></a> å¹³è¡¡æ ‘</h1>
<p>æˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ”¯æŒä»¥ä¸‹æ“ä½œï¼šæ’å…¥å€¼ï¼Œåˆ é™¤å€¼ï¼ŒæŸ¥è¯¢æ•°åœ¨é›†åˆä¸­çš„æ’åï¼ŒæŸ¥è¯¢æ’åä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> çš„æ•°ï¼Œæ±‚æŸä¸ªæ•°çš„å‰é©±ä¸åç»§ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥ç”¨äºŒå‰æœç´¢æ ‘ç»´æŠ¤ï¼Œä½†æ˜¯å¯ä»¥è¢«å¡æˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span> ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¦ç”¨åˆ°å¦å¤–ä¸€ç§æ•°æ®ç»“æ„ï¼Œå³å¹³è¡¡æ ‘æ¥ç»´æŠ¤è¿™äº›æ“ä½œã€‚</p>
<p>å¹³è¡¡æ ‘ç§ç±»è¾ƒå¤šï¼Œè¿™é‡Œä»…ä»‹ç»å…¶ä¸­çš„Splayã€Treapã€FHQ Treapã€‚</p>
<h2 id="splay"><a class="markdownIt-Anchor" href="#splay"></a> Splay</h2>
<p>å¹³è¡¡æ ‘æ˜¯åŸºäºBSTä¹Ÿå°±æ˜¯äºŒå‰æœç´¢æ ‘çš„ç»“æ„æ¥è¿›è¡Œç»´æŠ¤çš„ï¼Œå®ƒæœ‰ä¸€äº›æ€§è´¨ã€‚</p>
<p>å·¦å„¿å­ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span> æ ¹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>&lt;</mo></mrow><annotation encoding="application/x-tex">&lt;</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">&lt;</span></span></span></span> å³å„¿å­ï¼Œè¿™é‡Œçš„å°äºå·å¯ä»¥è‡ªå®šä¹‰ã€‚ä¸”ä¸­åºéå†å¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ‰åºåºåˆ—ã€‚</p>
<p>æˆ‘ä»¬åœ¨æ­£å¸¸æƒ…å†µä¸‹æ˜¾ç„¶å¯ä»¥ç”¨BSTçš„ç‰¹æ€§å»è·³å·¦å³å„¿å­å°±å¯ä»¥æ‰¾åˆ°ç›®æ ‡èŠ‚ç‚¹ï¼Œä½†æ˜¯åœ¨é“¾æ•°æ®ä¸‹ä¼šä» <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mclose">)</span></span></span></span> å¤æ‚åº¦å¡æˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>ã€‚</p>
<p>é‚£ä¹ˆï¼ŒSplayå°±æ˜¯é€šè¿‡å…¶ç‹¬ç‰¹çš„æ—‹è½¬æ“ä½œï¼Œç”¨æ—‹å­¦æ¥ç¨³å®šç„å­¦çš„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi><mo stretchy="false">(</mo><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">O(log(n))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span><span class="mclose">)</span></span></span></span> å¤æ‚åº¦ã€‚</p>
<p>å…³äºæ¯ä¸ªèŠ‚ç‚¹æˆ‘ä»¬éœ€è¦å­˜å‚¨çš„ä¿¡æ¯æœ‰è¿™äº›ï¼šçˆ¶èŠ‚ç‚¹ä¸å­èŠ‚ç‚¹ç¼–å·ï¼Œæƒå€¼ï¼Œæƒå€¼å‡ºç°æ¬¡æ•°ä¸æ­¤èŠ‚ç‚¹æ‰€åœ¨å­æ ‘çš„å¤§å°ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å†™å‡ºç»´æŠ¤å…¶åŸºæœ¬æ€§è´¨çš„ä»£ç ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-type">const</span> <span class="hljs-type">int</span> Maxn = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ls(x) son[x][0]</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rs(x) son[x][1]</span><br><br><span class="hljs-type">int</span> fa[Maxn], son[Maxn][<span class="hljs-number">2</span>];<br><span class="hljs-type">int</span> val[Maxn], cnt[Maxn];<br><span class="hljs-type">int</span> siz[Maxn];<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">clear</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">ls</span>(x) = <span class="hljs-built_in">rs</span>(x) = f[x] = siz[x] = cnt[x] = val[x] = <span class="hljs-number">0</span>, <span class="hljs-built_in">void</span>();<br>&#125; <span class="hljs-comment">//åˆ é™¤èŠ‚ç‚¹</span><br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> (<span class="hljs-built_in">rs</span>(f[x]) == x);<br>&#125; <span class="hljs-comment">//åˆ¤æ–­èŠ‚ç‚¹æ˜¯å·¦å„¿å­è¿˜æ˜¯å³å„¿å­</span><br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">up</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (x)<br>    &#123;<br>        siz[x] = cnt[x];<br>        <span class="hljs-built_in">ls</span>(x) ? siz[x] += siz[<span class="hljs-built_in">ls</span>(x)] : siz[x] = siz[x];<br>        <span class="hljs-built_in">rs</span>(x) ? siz[x] += siz[<span class="hljs-built_in">rs</span>(x)] : siz[x] = siz[x];<br>    &#125;<br><br>    <span class="hljs-keyword">return</span>;<br>&#125; <span class="hljs-comment">//ä¸Šä¼ </span><br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä¸‹ä¸€æ­¥å°±æ˜¯Splayçš„ç²¾é«“æ‰€åœ¨â€”â€”æ—‹è½¬ã€‚</p>
<p>æˆ‘ä»¬æ ¹æ®ä¸åŒçš„æƒ…å†µå»è°ƒæ•´ï¼Œç›´åˆ°æˆ‘ä»¬éœ€è¦çš„èŠ‚ç‚¹è½¬åˆ°äº†æ ¹èŠ‚ç‚¹å¤„</p>
<p>æ—‹è½¬çš„è¿‡ç¨‹ä¹Ÿå°±æ˜¯ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> èŠ‚ç‚¹é€æ¸å‘æ ¹ç»“ç‚¹é€¼è¿‘çš„è¿‡ç¨‹ã€‚é‚£ä¹ˆæˆ‘ä»¬æ¯æ¬¡æ—‹è½¬çš„æ—¶å€™å»è€ƒè™‘å°†å…¶æ—‹è½¬åˆ°å®ƒçˆ¶èŠ‚ç‚¹çš„ä½ç½®æ¥å‘ä¸Šé€¼è¿‘ã€‚</p>
<p>æ‰‹ç©ä¸€ä¸‹å¯å¾—ï¼Œæˆ‘ä»¬éœ€è¦æŠŠä» <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> åˆ°æ ¹èŠ‚ç‚¹ä¸Š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>a</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">fa[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span> è¿æ¥çš„è¾¹éƒ½åˆ æ‰ï¼Œç„¶åæŠŠ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>a</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">fa[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span> è¿æˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> çš„å³å„¿å­ä»¥ç»´æŠ¤BSTæ€§è´¨ï¼Œå¦‚æœ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> ç‚¹å­˜åœ¨å³å­æ ‘ï¼Œé‚£ä¹ˆå°±æŠŠå®ƒè¿åˆ° <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>a</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">fa[x]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span></span></span></span> çš„å·¦å­æ ‘ä¸Šï¼Œæœ€åå†æ›´æ–°ä¸€ä¸‹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mi>a</mi><mo stretchy="false">[</mo><mi>f</mi><mi>a</mi><mo stretchy="false">[</mo><mi>x</mi><mo stretchy="false">]</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">fa[fa[x]]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mord mathdefault">a</span><span class="mopen">[</span><span class="mord mathdefault">x</span><span class="mclose">]</span><span class="mclose">]</span></span></span></span> çš„å·¦å„¿å­å³å¯ã€‚</p>
<p>ä½†æ˜¯åœ¨ $ xã€fa[x]ã€fa[fa[x]] $ å…±çº¿çš„æƒ…å†µä¸‹ï¼Œå¦‚æœä»ç„¶æŒ‰ç…§ä»ä¸‹å¾€ä¸Šçš„é¡ºåºè½¬ï¼Œé‚£ä¹ˆæˆ‘ä»¬çš„é“¾ç»“æ„ä¼šè¢«ç ´åä»è€Œå¯¼è‡´å¤±è¡¡ã€‚æ­¤æ—¶å°±éœ€è¦ç”¨åŒæ—‹å»å¹³è¡¡ï¼Œå…¶å®ä¹Ÿå°±æ˜¯å…ˆè½¬çˆ¶èŠ‚ç‚¹å†è½¬å­èŠ‚ç‚¹ï¼Œæœ€ç»ˆå°±å¯ä»¥è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p>
<p>æœ€åä¸è¦å¿˜äº†ä¸Šä¼ ã€‚</p>
<p>å³</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">rotate</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> fx = f[x], gfx = f[fx];<br>    <span class="hljs-type">int</span> c = <span class="hljs-built_in">get</span>(ix);<br>    f[x] = gfx;<br>    f[fx] = x;<br>    son[fx][c] = ch[x][c ^ <span class="hljs-number">1</span>];<br>    son[x][c ^ <span class="hljs-number">1</span>] = fx;<br>    <span class="hljs-keyword">if</span> (son[x][c ^ <span class="hljs-number">1</span>])<br>        fa[son[x][c ^ <span class="hljs-number">1</span>]] = fx;<br>    <span class="hljs-keyword">if</span> (gfx)<br>        son[gfx][<span class="hljs-built_in">get</span>(fx)] = x;<br>    <span class="hljs-built_in">up</span>(fx);<br>    <span class="hljs-built_in">up</span>(x);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">Splay</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">while</span> (fa[x])<br>    &#123;<br>        <span class="hljs-keyword">if</span> (fa[fa[x]])<br>            <span class="hljs-built_in">rotate</span>(<span class="hljs-built_in">get</span>(x) == <span class="hljs-built_in">get</span>(fa[x]) ? fa[x] : x);<br>        <span class="hljs-built_in">rotate</span>(x);<br>    &#125;<br>    rt = x;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„æ“ä½œå°±å¥½è¯´äº†ï¼Œæˆ‘ä»¬å·²ç»ç»´æŠ¤å¥½äº†æ€§è´¨ï¼Œåªéœ€è¦åˆ©ç”¨æˆ‘ä»¬æ„å»ºçš„ä¼˜ç¾çš„å¹³è¡¡ç»“æ„å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">rt_pre</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-built_in">ls</span>(rt);<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">rs</span>(x))<br>        x = <span class="hljs-built_in">rs</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-keyword">return</span> x;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">rt_nxt</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> x = <span class="hljs-built_in">rs</span>(x);<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">ls</span>(x))<br>        x = <span class="hljs-built_in">ls</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-keyword">return</span> x;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">insert</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = rt, f = <span class="hljs-number">0</span>;<br><br>    <span class="hljs-keyword">while</span> (i <span class="hljs-keyword">and</span> val[i] != x)<br>        f = i, i = son[i][x &gt; val[i]];<br><br>    <span class="hljs-keyword">if</span> (i)<br>        cnt[i]++;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        i = tot++;<br>        cnt[tot] = siz[tot] = <span class="hljs-number">1</span>;<br>        val[tot] = x;<br>        fa[tot] = f;<br>        <span class="hljs-keyword">if</span> (f)<br>            son[f][x &gt; cal[f]] = i;<br>    &#125;<br><br>    <span class="hljs-built_in">up</span>(i);<br>    <span class="hljs-built_in">up</span>(fa[i]);<br><br>    <span class="hljs-keyword">if</span> (!rt)<br>        rt = i;<br>    <span class="hljs-built_in">splay</span>(i);<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">erase</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = rt;<br>    <span class="hljs-keyword">while</span> (i <span class="hljs-keyword">and</span> val[i] != x)<br>        i = son[i][x &gt; val[i]];<br><br>    <span class="hljs-keyword">if</span> (!i)<br>        <span class="hljs-keyword">return</span>;<br>    <span class="hljs-built_in">splay</span>(i);<br><br>    <span class="hljs-keyword">if</span> (!(--cnt[i]))<br>    &#123;<br>        <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">ls</span>(i) <span class="hljs-keyword">and</span> !<span class="hljs-built_in">rs</span>(i))<br>            <span class="hljs-built_in">clear</span>(i), rt = <span class="hljs-number">0</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">ls</span>(i))<br>            rt = <span class="hljs-built_in">rs</span>(i), fa[rt] = <span class="hljs-number">0</span>, <span class="hljs-built_in">clear</span>(i);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">rs</span>(i))<br>            rt = <span class="hljs-built_in">ls</span>(i), fa[rt] = <span class="hljs-number">0</span>, <span class="hljs-built_in">clear</span>(i);<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-type">int</span> p = <span class="hljs-built_in">rt_pre</span>();<br>            <span class="hljs-built_in">rs</span>(p) = <span class="hljs-built_in">rs</span>(i);<br>            fa[<span class="hljs-built_in">rs</span>(i)] = p;<br>            <span class="hljs-built_in">clear</span>(i);<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-built_in">up</span>(rt);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">rk</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> res = <span class="hljs-number">0</span>, i = rt;<br>    <span class="hljs-keyword">while</span> (i <span class="hljs-keyword">and</span> val[i] != x)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (x &lt; val[i])<br>            i = <span class="hljs-built_in">ls</span>(i);<br>        <span class="hljs-keyword">else</span><br>            res += siz[<span class="hljs-built_in">ls</span>(i)] + cnt[i], i = <span class="hljs-built_in">rs</span>(i);<br>    &#125;<br><br>    res += siz[<span class="hljs-built_in">ls</span>(i)];<br>    <span class="hljs-built_in">splay</span>(i);<br>    <span class="hljs-keyword">return</span> res + <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">kth</span><span class="hljs-params">(<span class="hljs-type">int</span> k)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> i = rt;<br>    <span class="hljs-keyword">while</span> (i)<br>    &#123;<br>        <span class="hljs-type">int</span> lcnt = siz[<span class="hljs-built_in">ls</span>(i)];<br>        <span class="hljs-keyword">if</span> (lcnt &lt; k <span class="hljs-keyword">and</span> k &lt;= lcnt + cnt[i])<br>            <span class="hljs-keyword">break</span>;<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (k &lt;= lcnt)<br>            i = <span class="hljs-built_in">ls</span>(i);<br>        <span class="hljs-keyword">else</span><br>            k -= lcnt + cnt[i], i = <span class="hljs-built_in">rs</span>(i);<br>    &#125;<br><br>    <span class="hljs-built_in">splay</span>(i);<br>    <span class="hljs-keyword">return</span> val[i];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">getpre</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> res = (<span class="hljs-built_in">insert</span>(x), <span class="hljs-built_in">rt_pre</span>());<br>    <span class="hljs-built_in">erase</span>(x);<br>    <span class="hljs-keyword">return</span> val[res];<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">getnxt</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> res = (<span class="hljs-built_in">insert</span>(x), <span class="hljs-built_in">rt_nxt</span>());<br>    <span class="hljs-built_in">erase</span>(x);<br>    <span class="hljs-keyword">return</span> val[res];<br>&#125;<br></code></pre></td></tr></table></figure>
<h2 id="treap"><a class="markdownIt-Anchor" href="#treap"></a> Treap</h2>
<p>æ ‘ä¸å †çš„ç»“åˆã€‚</p>
<p>åˆ©ç”¨äº†å †çš„æ€§è´¨ä¿è¯äº†æ ‘ç»“æ„çš„å¹³è¡¡ï¼Œå³å±‚æ•°è¾¾åˆ°æœŸæœ› <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mi>o</mi><mi>g</mi></mrow><annotation encoding="application/x-tex">log</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.03588em;">g</span></span></span></span> ã€‚</p>
<p>Treapçš„æ¯ä¸ªèŠ‚ç‚¹éœ€è¦ä¸€ä¸ªé¢å¤–çš„æƒå€¼ä½œä¸ºä¼˜å…ˆçº§ï¼Œå»ç»´æŠ¤å®ƒä½œä¸ºå †çš„æ€§è´¨ã€‚å› æ­¤æ•´æ£µæ ‘ä¸ä»…è¦ç¬¦åˆBSTçš„ç‰¹æ€§ï¼Œä¹Ÿè¦æ»¡è¶³çˆ¶èŠ‚ç‚¹çš„é¢å¤–æƒå€¼å¤§äºä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚</p>
<p>æˆ‘ä»¬ä¸€èˆ¬è®¾æ­¤æƒå€¼ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ord</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span></span></span></span> ï¼Œä¸”æ˜¯éšæœºç”Ÿæˆï¼Œå› æ­¤Treapæ˜¯ä¸€ç§å¼±å¹³è¡¡çš„ç»“æ„ã€‚</p>
<p>Treapæœ‰ä¸¤ç§å®ç°å½¢å¼ï¼Œæˆ‘ä»¬ä¸€ä¸€è®²è§£ã€‚</p>
<h3 id="å¸¦æ—‹treap"><a class="markdownIt-Anchor" href="#å¸¦æ—‹treap"></a> å¸¦æ—‹Treap</h3>
<p>æ˜¯Treapçš„æœ€åˆå½¢å¼ï¼Œç”¨â€œå·¦æ—‹â€ä¸â€œå³æ—‹â€å»ç»´æŠ¤å¹³è¡¡ï¼Œä½†å®ƒä¸æ”¯æŒåŒºé—´æ“ä½œã€‚</p>
<p>æˆ‘ä»¬å»å®šä¹‰ä¸€äº›å­˜å‚¨ç»“æ„ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> ls(x) son[x][0]</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rs(x) son[x][1]</span><br><span class="hljs-type">const</span> <span class="hljs-type">int</span> Maxn = <span class="hljs-number">1e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-type">int</span> fa[Maxn], son[Maxn][<span class="hljs-number">2</span>];<br><span class="hljs-type">int</span> val[Maxn], cnt[Maxn];<br><span class="hljs-type">int</span> siz[Maxn];<br><span class="hljs-type">int</span> ord[Maxn];<br></code></pre></td></tr></table></figure>
<p>å¸¦æ—‹çš„Treapå¸¸æ•°è¾ƒå°ä¸”ä¸å®¹æ˜“å¡ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šå¯¹æ¯ä¸€ä¸ªèŠ‚ç‚¹å»éšæœºå‡ºæ¥ä¸€ä¸ªå€¼ä½œä¸ºå †çš„ä¼˜å…ˆçº§ï¼ŒåŒæ—¶åœ¨æ¯æ¬¡åˆ é™¤æˆ–è€…æ’å…¥æ—¶æ ¹æ®è¿™ä¸ªæƒå€¼å»å†³å®šæ—‹è½¬ä¸å¦ã€‚</p>
<p>æ—‹è½¬ï¼š</p>
<p>æˆ‘ä»¬éœ€è¦åœ¨ä¸å½±å“æ ‘çš„æ€§è´¨çš„å‰æä¹‹ä¸‹ï¼ŒæŠŠå’Œæ—‹è½¬æ–¹å‘ç›¸åçš„å­æ ‘å˜ä¸ºæ ¹ï¼ŒæŠŠåŸæ¥æ ¹ç»“ç‚¹ä½œä¸ºä¸æ—‹è½¬æ–¹å‘ç›¸åŒçš„å­èŠ‚ç‚¹ï¼Œä¸”å·¦æ—‹ä¸å³æ—‹æ“ä½œæ˜¯ç›¸äº’çš„ã€‚</p>
<p>é‚£ä¹ˆå°±æ ¹æ®å †çš„æ€§è´¨å¾€ä¸Šè½¬å³å¯ï¼Œå› ä¸ºæ˜¯å°æ ¹å †ï¼Œé‚£ä¹ˆä¸Šé¢çš„ä¼˜å…ˆçº§ä¸€å®šä¼šæ›´å°ã€‚æœ€ç»ˆä¹Ÿå°±æ˜¯è®©å·¦å­èŠ‚ç‚¹æˆ–è€…å³å­èŠ‚ç‚¹å˜ä¸ºæ ¹ç»“ç‚¹å³å¯ã€‚</p>
<pre><code>        A                 C
       / \               / \
      B   C    ----&gt;    A   E
         / \           / \
        D   E         B   D
</code></pre>
<p><img src="https://oi-wiki.org/ds/images/treap-rotate.svg" alt="" /></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">up</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> siz[x]=siz[<span class="hljs-built_in">ls</span>(x)]+siz[<span class="hljs-built_in">rs</span>(x)]+<span class="hljs-number">1</span>,<span class="hljs-built_in">void</span>();<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">spin</span><span class="hljs-params">(<span class="hljs-type">int</span> &amp;i,<span class="hljs-type">int</span> p)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> t=s[i][p];<br>    s[i][p]=s[t][!p];<br>    s[t][!p]=i;<br>    <span class="hljs-built_in">up</span>(i); <span class="hljs-built_in">up</span>(t);<br>    i=t;<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ’å…¥å’Œæ™®é€šçš„BSTæ²¡å•¥å¤ªå¤§åŒºåˆ«ï¼Œåªéœ€è¦æ³¨æ„è¦é€šè¿‡æ—‹è½¬æ¥ç»´æŠ¤å †çš„æ€§è´¨ã€‚è‡³äºåˆ é™¤çš„è¯å°±å¤§åŠ›åˆ†ç±»è®¨è®ºå³å¯ï¼Œè€ƒè™‘åˆ é™¤åè°é€‚åˆå½“çˆ¶èŠ‚ç‚¹ï¼Œä¸”è¦æ³¨æ„æ›´æ”¹æ ‘çš„å¤§å°ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥å†æ¬¡åˆ©ç”¨æ„å»ºçš„æ€§è´¨å»è¿›è¡Œæ“ä½œã€‚</p>
<p>æ³¨æ„ä»æ ¹ç»“ç‚¹å¼€å§‹é€’å½’ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">ins</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> &amp;i)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!i)<br>    &#123;<br>        i = ++tot;<br>        siz[i] = <span class="hljs-number">1</span>;<br>        val[i] = x, pri[i] = <span class="hljs-built_in">rand</span>();<br>        <span class="hljs-keyword">return</span>;<br>    &#125;<br><br>    siz[i]++;<br>    <span class="hljs-keyword">if</span> (x &lt;= val[i])<br>    &#123;<br>        <span class="hljs-built_in">ins</span>(x, <span class="hljs-built_in">ls</span>(i));<br>        <span class="hljs-keyword">if</span> (pri[<span class="hljs-built_in">ls</span>(i)] &lt; pri[i])<br>            <span class="hljs-built_in">spin</span>(i, <span class="hljs-number">0</span>);<br>    &#125;<br>    <span class="hljs-keyword">else</span><br>    &#123;<br>        <span class="hljs-built_in">ins</span>(x, <span class="hljs-built_in">rs</span>(i));<br>        <span class="hljs-keyword">if</span> (pri[<span class="hljs-built_in">rs</span>(i)] &lt; pri[i])<br>            <span class="hljs-built_in">spin</span>(i, <span class="hljs-number">1</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">del</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> &amp;i)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (x == val[i])<br>    &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ls</span>(i) * <span class="hljs-built_in">rs</span>(i) == <span class="hljs-number">0</span>)<br>        &#123;<br>            i = son[i][<span class="hljs-number">0</span>] + son[i][<span class="hljs-number">1</span>];<br>            <span class="hljs-keyword">return</span>;<br>        &#125;<br>        <span class="hljs-keyword">if</span> (pri[<span class="hljs-built_in">ls</span>(i)] &gt; pri[<span class="hljs-built_in">rs</span>(i)])<br>        &#123;<br>            <span class="hljs-built_in">spin</span>(i, <span class="hljs-number">1</span>);<br>            <span class="hljs-built_in">del</span>(x, <span class="hljs-built_in">ls</span>(i));<br>        &#125;<br>        <span class="hljs-keyword">else</span><br>        &#123;<br>            <span class="hljs-built_in">spin</span>(i, <span class="hljs-number">0</span>);<br>            <span class="hljs-built_in">del</span>(x, <span class="hljs-built_in">rs</span>(i));<br>        &#125;<br>    &#125;<br>    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (val[i] &gt; x)<br>        <span class="hljs-built_in">del</span>(x, <span class="hljs-built_in">ls</span>(i));<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-built_in">del</span>(x, <span class="hljs-built_in">rs</span>(i));<br><br>    <span class="hljs-built_in">up</span>(i);<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">rk</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> i)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!i)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">if</span> (val[i] &gt;= x)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">rk</span>(x, <span class="hljs-built_in">ls</span>(i));<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">rk</span>(x, <span class="hljs-built_in">rs</span>(i)) + siz[<span class="hljs-built_in">ls</span>(i)] + <span class="hljs-number">1</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">kth</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> i)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (siz[<span class="hljs-built_in">ls</span>(i)] == x - <span class="hljs-number">1</span>)<br>        <span class="hljs-keyword">return</span> w[i];<br>    <span class="hljs-keyword">if</span> (siz[<span class="hljs-built_in">ls</span>(i)] &gt;= x)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">ask</span>(x, <span class="hljs-built_in">ls</span>(i));<br><br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">kth</span>(x - siz[<span class="hljs-built_in">ls</span>(i)] - <span class="hljs-number">1</span>, <span class="hljs-built_in">rs</span>(i));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">pre</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> i)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!i)<br>        <span class="hljs-keyword">return</span> -inf;<br>    <span class="hljs-keyword">if</span> (val[i] &lt; x)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">max</span>(val[i], <span class="hljs-built_in">pre</span>(x, <span class="hljs-built_in">rs</span>(i)));<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">pre</span>(x, <span class="hljs-built_in">ls</span>(i));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">nxt</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> i)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (!i)<br>        <span class="hljs-keyword">return</span> inf;<br>    <span class="hljs-keyword">if</span> (val[i] &gt; x)<br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">min</span>(val[i], <span class="hljs-built_in">nxt</span>(x, <span class="hljs-built_in">ls</span>(i)));<br>    <span class="hljs-keyword">else</span><br>        <span class="hljs-keyword">return</span> <span class="hljs-built_in">nxt</span>(x, <span class="hljs-built_in">rs</span>(i));<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="fhq-treap"><a class="markdownIt-Anchor" href="#fhq-treap"></a> FHQ Treap</h3>
<p>å³æ— æ—‹Treapã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬ä¸æ—‹è½¬äº†ï¼Œæ¢ç”¨åˆ†è£‚ä¸åˆå¹¶å»ç»´æŠ¤æ ‘çš„ç‰¹æ€§ã€‚</p>
<p>å°±æ˜¯æŠŠæ ‘æ‹†å¼€ï¼Œæ‹¼ä¸Šï¼Œå†æ‹†å¼€ï¼Œå†æ‹¼ä¸Šã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬éœ€è¦å­˜å‚¨äº”ç§ä¿¡æ¯ï¼Œå·¦å³å­æ ‘ç¼–å·ï¼Œæƒå€¼ï¼Œå­æ ‘å¤§å°ï¼Œç´¢å¼•ã€‚</p>
<p>åˆ†è£‚åˆ†ä¸ºä¸¤ç§ï¼Œåˆ†åˆ«ä¸ºæŒ‰å€¼åˆ†è£‚ä¸æŒ‰å¤§å°åˆ†è£‚ã€‚</p>
<p>åœ¨é€šå¸¸æƒ…å†µä¸‹ï¼ŒFHQä»…å‘æŒ¥å¹³è¡¡æ ‘åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬æŒ‰å€¼åˆ†è£‚ï¼Œå½“ç»´æŠ¤åŒºé—´ä¿¡æ¯æ—¶æˆ‘ä»¬å°±éœ€è¦å»æŒ‰ç…§å¤§å°åˆ†è£‚ï¼Œå³æ–‡è‰ºå¹³è¡¡æ ‘ã€‚</p>
<p>åˆå¹¶æ—¶å°±ä¸€ç§ï¼Œå³æŠŠä¸¤æ£µæ ‘åˆäºŒä¸ºä¸€ï¼Œå…¶ä¸­ä¸€æ ‘ä¸Šçš„æ‰€æœ‰æƒå€¼éƒ½éœ€è¦å°äºå¦ä¸€æ£µå¾…åˆå¹¶çš„æ ‘ï¼Œä»¥æ­¤æ¥ç»´æŒTreapçš„æ€§è´¨ã€‚</p>
<p>é¦–å…ˆæ¥è¯´æ’å…¥ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è¦æ’å…¥å®ƒï¼Œè‚¯å®šæ˜¯æŒ‰ç…§æ’å…¥å€¼ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> æ¥åˆ†ç±»ï¼Œå¾—åˆ°ä¸€æ£µæƒå€¼å…¨éƒ¨å¤§äºå®ƒçš„æ ‘ä¸å¦ä¸€æ£µæƒå€¼å…¨éƒ¨å°äºå®ƒçš„æ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥åˆå¹¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> å’Œç”¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> æ–°å»ºçš„èŠ‚ç‚¹ï¼Œæœ€åå¹¶ä¸Š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> å°±å¤§åŠŸå‘Šæˆã€‚</p>
<p>å†è¯´åˆ é™¤ã€‚</p>
<p>æˆ‘ä»¬è¿˜æ˜¯å…ˆæŒ‰ç…§ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> åˆ†è£‚æˆä¸¤æ£µæ ‘ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>z</mi></mrow><annotation encoding="application/x-tex">x,z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.04398em;">z</span></span></span></span>ï¼Œå†æŒ‰ç…§ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">val-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> æŠŠå…¶ä¸­ä¸€æ£µ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> åˆ†è£‚ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸‰æ£µæ ‘ï¼Œæ­¤æ—¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ä¸Šæ‰€æœ‰æƒå€¼éƒ½ä¼šç­‰äº <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>ã€‚é‚£ä¹ˆæˆ‘ä»¬åˆ é™¤å®ƒçš„æ ¹ç»“ç‚¹ï¼Œè®© <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ç­‰äºåˆå¹¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> çš„å·¦å­æ ‘ä¸æœ‰å­—æ•°ï¼Œæœ€åå†åˆå¹¶ä¸Š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>ã€‚</p>
<p>å‰é©±çš„è¯ç›´æ¥æŒ‰ç…§ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">val-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> åˆ†è£‚ï¼Œåœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>é‡Œæœ€å³çš„æ•°å³ä¸ºå‰é©±ã€‚</p>
<p>åç»§åŒæ ·ï¼ŒæŒ‰ç…§<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow><annotation encoding="application/x-tex">val</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>åˆ†è£‚ï¼Œåœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>ä¸­æœ€å·¦çš„æ•°å³ä¸ºåç»§ã€‚</p>
<p>è‡³äºå»ºæ ‘ï¼Œæˆ‘ä»¬å‘ç°Treapå…¶å®æ˜¯ç¬›å¡å°”æ ‘ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç›´æ¥åˆ©ç”¨ç¬›å¡å°”æ ‘<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o(n)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord mathdefault">n</span><span class="mclose">)</span></span></span></span>å»ºæ ‘æ–¹æ³•å³å¯ï¼Œå³å•è°ƒæ ˆç»´æŠ¤å³é“¾ã€‚</p>
<h5 id="fhqçš„åŒºé—´æ“ä½œ"><a class="markdownIt-Anchor" href="#fhqçš„åŒºé—´æ“ä½œ"></a> FHQçš„åŒºé—´æ“ä½œ</h5>
<p>ç›¸æ¯”äºå¸¦æ—‹Treapæ¥è¯´ï¼ŒFHQçš„ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯å¯ä»¥å®ç°å„ç§åŒºé—´æ“ä½œã€‚æˆ‘ä»¬ä»¥æ–‡è‰ºå¹³è¡¡æ ‘ä¸ºä¾‹æ¥ä»‹ç»å„ç§åŒºé—´æ“ä½œã€‚</p>
<p>æ–‡è‰ºå¹³è¡¡æ ‘çš„ç‰¹åˆ«ä¹‹å¤„å°±æ˜¯éœ€è¦æä¾›ä¸€ä¸ªåŒºé—´ç¿»è½¬æ“ä½œï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆè€ƒè™‘å»å»ºæ ‘ï¼Œå»ºå‡ºæ¥çš„æ ‘éœ€è¦æ˜¯æˆ‘ä»¬æœ€åˆå§‹çš„åŒºé—´ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŠŠåŒºé—´ä¸‹æ ‡ä»¥æ­¤åœ°æ’å…¥Treapï¼Œé‚£ä¹ˆä¸­åºéå†ä¹‹åæˆ‘ä»¬å°±èƒ½æ–¹ä¾¿åœ°å¾—åˆ°è¿™ä¸ªåŒºé—´ã€‚</p>
<p>ä½†æ˜¯Treapè¿˜ä¼šæ ¹æ®å †çš„æ€§è´¨æ¥è°ƒæ•´æ ‘çš„ç»“æ„ï¼Œå¦‚ä½•ç¡®ä¿ä¸­åºéå†æ­£ç¡®è¾“å‡ºå°±æ˜¯æˆ‘ä»¬äºŸéœ€è§£å†³çš„ä¸€ä¸ªé—®é¢˜ã€‚</p>
<p>å…¶å®æˆ‘ä»¬è¿˜æ˜¯å¯ä»¥å‚è€ƒç¬›å¡å°”æ ‘çš„å•è°ƒæ ˆå»ºæ ‘æ–¹æ³•æ¥è§£å†³å®ƒã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬è®¾æ–°æ’å…¥çš„èŠ‚ç‚¹ä¸º<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>ï¼Œæ¯ä¸€ä¸ªæ–°æ’å…¥çš„èŠ‚ç‚¹ä¸€å®šä¼šè¢«è¿åˆ°Treapçš„å³é“¾ä¸­ã€‚</p>
<p>ä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œå³é“¾ä¸Š <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ord</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span></span></span></span> æ˜¾ç„¶æ˜¯é€’å¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯åœ¨æ­¤é“¾ä¸Šæ‰¾åˆ°ç¬¬ä¸€ä¸ª <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mi>r</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">ord</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">o</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">d</span></span></span></span> å¤§äº <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span>ï¼Œå¹¶ä¸”æŠŠå®ƒæ›¿æ¢æˆ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>ã€‚</p>
<p>åˆå› ä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> ä¸€å®šä¼šå¤§äºæ ‘ä¸Šçš„å…¶å®ƒå…¨éƒ¨èŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi></mrow><annotation encoding="application/x-tex">v</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">v</span></span></span></span>åŠå…¶å­æ ‘ä½œä¸º <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> çš„å·¦å­æ ‘ï¼Œå¹¶ä¸” <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> æ­¤æ—¶å¹¶æ²¡æœ‰å³å­æ ‘ã€‚</p>
<p>é‚£ä¹ˆæ˜¾ç„¶ä¸­åºéå†æ—¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> ä¸€å®šä¸ºæœ€åä¸€ä¸ªè¢«éå†çš„ã€‚</p>
<p><img src="https://oi-wiki.org/ds/images/treap-none-rot-seg-build.svg" alt="" /></p>
<h5 id="åŒºé—´ç¿»è½¬"><a class="markdownIt-Anchor" href="#åŒºé—´ç¿»è½¬"></a> åŒºé—´ç¿»è½¬</h5>
<p>æˆ‘ä»¬éœ€è¦ç¿»è½¬ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span>,é‚£ä¹ˆåŸºæœ¬æ€è·¯æ˜¯æŠŠæ ‘åˆ†è£‚æˆ $[1,l-1],[l,r],[r+1,n] $ ä¸‰ä¸ªåŒºé—´ï¼Œå†å¯¹ä¸­é—´çš„ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>l</mi><mo separator="true">,</mo><mi>r</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[l,r]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mclose">]</span></span></span></span> è¿›è¡Œç¿»è½¬æ“ä½œã€‚</p>
<p>ç¿»è½¬çš„å…·ä½“æ“ä½œå…¶å®å°±æ˜¯æŠŠåŒºé—´å†…å­æ ‘çš„æ¯ä¸€ä¸ªå·¦å³å„¿å­éƒ½äº¤æ¢ä½ç½®ã€‚</p>
<p>å¦‚å›¾,å°±æ˜¯ç¿»è½¬äº†ä¸Šå›¾çš„Treapï¼š</p>
<p><img src="https://oi-wiki.org/ds/images/treap-none-rot-seg-flip-ex.svg" alt="" /></p>
<p>å¦‚æœç¿»è½¬æ˜¯è¿™ä¸ªæ–¹å¼ï¼Œé‚£ä¹ˆæ¯æ¬¡ç¿»è½¬åŒºé—´æ—¶ï¼Œéƒ½ä¼šæœ‰ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi><mo>âˆ’</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">r-l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> ä¸ªåŒºé—´è¢«äº¤æ¢ä½ç½®ï¼Œæ—¶é—´å¤æ‚åº¦ä¼šå¾ˆé«˜ï¼Œå¦‚ä½•å¤„ç†ï¼Ÿ</p>
<p>æˆ‘ä»¬å›æƒ³ä¸€ä¸‹åœ¨çº¿æ®µæ ‘é‡åˆ°è¿™ç§æƒ…å†µæ—¶æ˜¯æ€ä¹ˆå¤„ç†çš„ï¼Ÿæ˜¾ç„¶ï¼ŒLazy Tagå³å¯è§£å†³é—®é¢˜ã€‚</p>
<p>æˆ‘ä»¬åªéœ€è¦åœ¨çˆ¶èŠ‚ç‚¹æ‰“ä¸Šæ ‡è®°ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä»£è¡¨æ•´è¯¾å­æ ‘çš„å·¦å³å­èŠ‚ç‚¹éƒ½è¦äº¤æ¢ã€‚</p>
<p>åŒæ—¶è¦æ³¨æ„æˆ‘ä»¬åº”è¯¥åœ¨åˆ†è£‚æ—¶ä¸‹ä¼ æ ‡è®°ï¼Œåˆå› åˆå¹¶éœ€è¦åˆ†è£‚ï¼Œé‚£ä¹ˆåˆå¹¶å‰ä¹Ÿéœ€è¦ä¸‹ä¼ ã€‚</p>
<p>é‚£ä¹ˆï¼Œæˆ‘ä»¬å°±æ˜¯åœ¨æ ‘çš„ç»“æ„æ”¹å˜æ—¶ï¼Œæˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ†è£‚æˆ–è€…åˆå¹¶æ“ä½œæ—¶ï¼Œéœ€è¦æ”¹å˜æŸä¸ªç‚¹çš„å·¦å³å„¿å­ä¿¡æ¯æ—¶ï¼Œæ“ä½œä¹‹å‰ä¹Ÿåº”ä¸‹ä¼ æ ‡è®°ã€‚</p>
<p>æ²¡äº†ã€‚</p>
<p>ï¼ˆä»£ç ä¸æ˜¯æˆ‘çš„ï¼‰</p>
<p>FHQ Treap</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span> </span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">1e5</span>+<span class="hljs-number">105</span>;<br><span class="hljs-type">int</span> son[N][<span class="hljs-number">3</span>],val[N],ran[N],siz[N],SIZE,n,root,x,y,z,opt,a;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Up</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;siz[x]=<span class="hljs-number">1</span>+siz[son[x][<span class="hljs-number">0</span>]]+siz[son[x][<span class="hljs-number">1</span>]];&#125; <br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">New</span><span class="hljs-params">(<span class="hljs-type">int</span> v)</span></span>&#123;<br>	siz[++SIZE]=<span class="hljs-number">1</span>;<br>	val[SIZE]=v;ran[SIZE]=<span class="hljs-built_in">rand</span>();<br>	<span class="hljs-keyword">return</span> SIZE;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>&#123;<br>	<span class="hljs-keyword">if</span>(!x||!y) <span class="hljs-keyword">return</span> x+y;<br>	<span class="hljs-keyword">if</span>(ran[x]&lt;ran[y])&#123;<br>		son[x][<span class="hljs-number">1</span>]=<span class="hljs-built_in">merge</span>(son[x][<span class="hljs-number">1</span>],y);<br>		<span class="hljs-built_in">Up</span>(x);<span class="hljs-keyword">return</span> x;<br>	&#125;<br>	<span class="hljs-keyword">else</span> &#123;<br>		son[y][<span class="hljs-number">0</span>]=<span class="hljs-built_in">merge</span>(x,son[y][<span class="hljs-number">0</span>]);<br>		<span class="hljs-built_in">Up</span>(y);<span class="hljs-keyword">return</span> y;<br>	&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-type">int</span> p,<span class="hljs-type">int</span> k,<span class="hljs-type">int</span> &amp;x,<span class="hljs-type">int</span> &amp;y)</span></span>&#123;<br>	<span class="hljs-keyword">if</span>(!p) x=y=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">else</span>&#123;<br>		<span class="hljs-keyword">if</span>(val[p]&lt;=k) x=p,<span class="hljs-built_in">split</span>(son[p][<span class="hljs-number">1</span>],k,son[p][<span class="hljs-number">1</span>],y);<br>		<span class="hljs-keyword">else</span> y=p,<span class="hljs-built_in">split</span>(son[p][<span class="hljs-number">0</span>],k,x,son[p][<span class="hljs-number">0</span>]);<br>		<span class="hljs-built_in">Up</span>(p);<br>	&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">kth</span><span class="hljs-params">(<span class="hljs-type">int</span> p,<span class="hljs-type">int</span> k)</span></span>&#123;<br>	<span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>)&#123;<br>		<span class="hljs-keyword">if</span>(k&lt;=siz[son[p][<span class="hljs-number">0</span>]])p=son[p][<span class="hljs-number">0</span>];<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(k==siz[son[p][<span class="hljs-number">0</span>]]+<span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> p;<br>		<span class="hljs-keyword">else</span> k-=siz[son[p][<span class="hljs-number">0</span>]]+<span class="hljs-number">1</span>,p=son[p][<span class="hljs-number">1</span>];<br>	&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-built_in">srand</span>(<span class="hljs-number">1e9</span>+<span class="hljs-number">7</span>);<br>	<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d&quot;</span>,&amp;n);<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)&#123;<br>		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;opt,&amp;a);<br>		<span class="hljs-keyword">if</span>(opt==<span class="hljs-number">1</span>)&#123;<span class="hljs-comment">//æ’å…¥ </span><br>			<span class="hljs-built_in">split</span>(root,a,x,y);<br>			root=<span class="hljs-built_in">merge</span>(<span class="hljs-built_in">merge</span>(x,<span class="hljs-built_in">New</span>(a)),y);<br>		&#125;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">2</span>)&#123;<br>			<span class="hljs-built_in">split</span>(root,a,x,z);<span class="hljs-built_in">split</span>(x,a<span class="hljs-number">-1</span>,x,y);<br>			y=<span class="hljs-built_in">merge</span>(son[y][<span class="hljs-number">0</span>],son[y][<span class="hljs-number">1</span>]);root=<span class="hljs-built_in">merge</span>(<span class="hljs-built_in">merge</span>(x,y),z);<br>		&#125;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">3</span>)&#123;<br>			<span class="hljs-built_in">split</span>(root,a<span class="hljs-number">-1</span>,x,y);<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,siz[x]+<span class="hljs-number">1</span>);<br>			root=<span class="hljs-built_in">merge</span>(x,y);<br>		&#125;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">4</span>)&#123;<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,val[<span class="hljs-built_in">kth</span>(root,a)]);&#125;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">5</span>)&#123;<br>			<span class="hljs-built_in">split</span>(root,a<span class="hljs-number">-1</span>,x,y);<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,val[<span class="hljs-built_in">kth</span>(x,siz[x])]);<br>			root=<span class="hljs-built_in">merge</span>(x,y);<br>		&#125;<br>		<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(opt==<span class="hljs-number">6</span>)&#123;<br>			<span class="hljs-built_in">split</span>(root,a,x,y);<br>			<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>,val[<span class="hljs-built_in">kth</span>(y,<span class="hljs-number">1</span>)]);<br>			root=<span class="hljs-built_in">merge</span>(x,y);<br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>FHQ TreapåŒºé—´æ“ä½œ</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><code class="hljs cpp">/<span class="hljs-meta">#<span class="hljs-keyword">include</span><span class="hljs-string">&lt;bits/stdc++.h&gt;</span> </span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> N=<span class="hljs-number">1e5</span>+<span class="hljs-number">105</span>;<br><span class="hljs-type">int</span> son[N][<span class="hljs-number">3</span>],val[N],ran[N],siz[N],SIZE,n,root,m;<br><span class="hljs-type">bool</span> f[N];<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Up</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;siz[x]=<span class="hljs-number">1</span>+siz[son[x][<span class="hljs-number">0</span>]]+siz[son[x][<span class="hljs-number">1</span>]];&#125; <br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Down</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>	<span class="hljs-built_in">swap</span>(son[x][<span class="hljs-number">0</span>],son[x][<span class="hljs-number">1</span>]);<br>	<span class="hljs-keyword">if</span>(son[x][<span class="hljs-number">0</span>])f[son[x][<span class="hljs-number">0</span>]]^=<span class="hljs-number">1</span>;<br>	<span class="hljs-keyword">if</span>(son[x][<span class="hljs-number">1</span>])f[son[x][<span class="hljs-number">1</span>]]^=<span class="hljs-number">1</span>;<br>	f[x]=<span class="hljs-number">0</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">New</span><span class="hljs-params">(<span class="hljs-type">int</span> v)</span></span>&#123;<br>	siz[++SIZE]=<span class="hljs-number">1</span>;<br>	val[SIZE]=v;ran[SIZE]=<span class="hljs-built_in">rand</span>();<br>	<span class="hljs-keyword">return</span> SIZE;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">merge</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span>&#123;<br>	<span class="hljs-keyword">if</span>(!x||!y) <span class="hljs-keyword">return</span> x+y;<br>	<span class="hljs-keyword">if</span>(ran[x]&lt;ran[y])&#123;<br>		<span class="hljs-keyword">if</span>(f[x])<span class="hljs-built_in">Down</span>(x);<br>		son[x][<span class="hljs-number">1</span>]=<span class="hljs-built_in">merge</span>(son[x][<span class="hljs-number">1</span>],y);<br>		<span class="hljs-built_in">Up</span>(x);<span class="hljs-keyword">return</span> x;<br>	&#125;<br>	<span class="hljs-keyword">else</span> &#123;<br>		<span class="hljs-keyword">if</span>(f[y])<span class="hljs-built_in">Down</span>(y);<br>		son[y][<span class="hljs-number">0</span>]=<span class="hljs-built_in">merge</span>(x,son[y][<span class="hljs-number">0</span>]);<br>		<span class="hljs-built_in">Up</span>(y);<span class="hljs-keyword">return</span> y;<br>	&#125;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-type">int</span> p,<span class="hljs-type">int</span> k,<span class="hljs-type">int</span> &amp;x,<span class="hljs-type">int</span> &amp;y)</span></span>&#123;<br>	<span class="hljs-keyword">if</span>(!p) x=y=<span class="hljs-number">0</span>;<br>	<span class="hljs-keyword">else</span>&#123;<br>		<span class="hljs-keyword">if</span>(f[p])<span class="hljs-built_in">Down</span>(p);<span class="hljs-comment">//ä¸‹é¢ç”¨sizï¼Œè€Œä¸æ˜¯val </span><br>		<span class="hljs-keyword">if</span>(siz[son[p][<span class="hljs-number">0</span>]]&lt;k) x=p,<span class="hljs-built_in">split</span>(son[p][<span class="hljs-number">1</span>],k-siz[son[p][<span class="hljs-number">0</span>]]<span class="hljs-number">-1</span>,son[p][<span class="hljs-number">1</span>],y);<br>		<span class="hljs-keyword">else</span> y=p,<span class="hljs-built_in">split</span>(son[p][<span class="hljs-number">0</span>],k,x,son[p][<span class="hljs-number">0</span>]);<br>		<span class="hljs-built_in">Up</span>(p);<br>	&#125;<br>&#125;<br><span class="hljs-comment">/*int kth(int p,int k)&#123;</span><br><span class="hljs-comment">	while(1)&#123;</span><br><span class="hljs-comment">		if(k&lt;=siz[son[p][0]])p=son[p][0];</span><br><span class="hljs-comment">		else if(k==siz[son[p][0]]+1) return p;</span><br><span class="hljs-comment">		else k-=siz[son[p][0]]+1,p=son[p][1];</span><br><span class="hljs-comment">	&#125;</span><br><span class="hljs-comment">&#125;*/</span><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">out</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span>&#123;<br>	<span class="hljs-keyword">if</span>(!x) <span class="hljs-keyword">return</span> ;<br>	<span class="hljs-keyword">if</span>(f[x])<span class="hljs-built_in">Down</span>(x);<br>	<span class="hljs-built_in">out</span>(son[x][<span class="hljs-number">0</span>]);<br>	<span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d &quot;</span>,val[x]) ;<br>	<span class="hljs-built_in">out</span>(son[x][<span class="hljs-number">1</span>]);<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>&#123;<br>	<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;n,&amp;m);<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=n;i++)root=<span class="hljs-built_in">merge</span>(root,<span class="hljs-built_in">New</span>(i));<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)&#123;<br>		<span class="hljs-type">int</span> l,r,x,y,z;<br>		<span class="hljs-built_in">scanf</span>(<span class="hljs-string">&quot;%d%d&quot;</span>,&amp;l,&amp;r);<br>		<span class="hljs-built_in">split</span>(root,l<span class="hljs-number">-1</span>,x,y);<span class="hljs-built_in">split</span>(y,r-l+<span class="hljs-number">1</span>,y,z);<br>		f[y]^=<span class="hljs-number">1</span>;root=<span class="hljs-built_in">merge</span>(x,<span class="hljs-built_in">merge</span>(y,z));<br>	&#125;<br>	<span class="hljs-built_in">out</span>(root);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>æ²¡äº†ã€‚</p>
<h1 id="åŠ¨æ€æ ‘"><a class="markdownIt-Anchor" href="#åŠ¨æ€æ ‘"></a> åŠ¨æ€æ ‘</h1>
<h2 id="lct"><a class="markdownIt-Anchor" href="#lct"></a> LCT</h2>
<p>å¦‚æœæˆ‘ä»¬éœ€è¦ç»´æŠ¤ä¸€æ£µæ ‘ï¼Œæ”¯æŒé“¾ä¸Šæ±‚å’Œã€é“¾ä¸Šæ±‚æœ€å€¼ã€é“¾ä¸Šä¿®æ”¹ã€å­æ ‘ä¿®æ”¹ã€å­æ ‘æ±‚å’Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ç”¨æ ‘å‰–è½»æ¾åœ°è¿‡æ‰ã€‚</p>
<p>é‚£å¦‚æœæˆ‘ä»¬è¦é¢å¤–æ”¯æŒæ¢æ ¹ã€æ–­è¾¹ã€è¿ç‚¹è¿™å‡ ä¸ªæ“ä½œå‘¢ï¼Ÿæ˜¾ç„¶æ ‘å‰–å°±ä¸å¤ªå¤Ÿçœ‹äº†ã€‚å› ä¸ºæ ‘å‰–æ˜¯é™æ€çš„ï¼Œä¸èƒ½åŠ è¾¹æˆ–è€…åˆ è¾¹ã€‚</p>
<p>æ€ä¹ˆè§£å†³ï¼ŸLCTå³å¯ã€‚</p>
<p>æ²¡é”™ï¼Œå°±æ˜¯LinkCutTreeã€‚</p>
<p>å®ƒç”¨æ¥è§£å†³åŠ¨æ€æ ‘é—®é¢˜ï¼Œå³å¸¦ä¿®æ”¹è¾¹çš„æ ‘å‰–ï¼Œå…¶æœ¬è´¨æ˜¯åˆ©ç”¨è™šå®é“¾å‰–åˆ†å»ç»´æŠ¤ã€‚</p>
<p>ä¸€ä¸ªèŠ‚ç‚¹æœ€å¤šä¼šè¿å‡ºä¸€æ¡å®è¾¹æŒ‡å‘å„¿å­ï¼Œå› æ­¤å®è¾¹å¿…å®šä¼šèšæˆå®é“¾ã€‚é‚£ä¹ˆæ ¹æ®æ ‘å‰–çš„æ€æƒ³ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦ä¸€ä¸ªæ•°æ®ç»“æ„å»ç»´æŠ¤åŠ¨æ€çš„ä¸œè¥¿â€”â€”å¹³è¡¡æ ‘ï¼</p>
<p>æˆ‘ä»¬è¿™é‡Œé€‰ç”¨Splayå»ç»´æŠ¤ã€‚</p>
<p>å®ƒä¸è½»é‡é“¾å‰–åˆ†æœ€å¤§çš„ä¸åŒåœ¨äºé‡é“¾æ˜¯åé™æ€çš„ï¼Œä½†æ˜¯åè·¯å¾„æ˜¯åŠ¨æ€çš„ã€‚</p>
<p>LCTç»´æŠ¤çš„å¯¹è±¡æœ¬è´¨ä¸Šæ˜¯ä¸€ç‰‡æ£®æ—ï¼Œéƒ½æ˜¯ç”±çº¯è™šè¾¹æˆ–è€…çº¯å®è¾¹æ„æˆçš„<s>çº¯ç§</s>æ ‘ã€‚</p>
<p>ç”±æ­¤LCTä¼šæœ‰ä¸€äº›ç¥å¥‡çš„æ€§è´¨:<br />
1.æ¯ä¸€ä¸ªSplayéƒ½æ˜¯ç»´æŠ¤çš„ä¸€æ¡ä»ä¸Šåˆ°ä¸‹çš„è·¯å¾„ï¼Œä¸”åœ¨åŸæ ‘ä¸­çš„æ·±åº¦ä¼šå•è°ƒé€’å¢ã€‚é‚£ä¹ˆæ˜¾ç„¶ï¼ŒåŒä¸€æ£µSplayä¸­ä¸ä¼šæœ‰åŒä¸€å±‚çš„èŠ‚ç‚¹ï¼Œå³ä¸€ä¸ªçˆ¶äº²çš„å„¿å­é‡Œæœ€å¤šåªä¼šå­˜åœ¨ä¸€ä¸ªåœ¨åŒ…å«çˆ¶äº²çš„Splayä¸­ã€‚<br />
2.æ¯ä¸ªèŠ‚ç‚¹åŒ…å«ä¸”ä»…åŒ…å«äºä¸€ä¸ªSplayä¸­ï¼Œå³å„ä¸ªSplayçš„ç‚¹é›†ä¸å­˜åœ¨äº¤é›†ã€‚<br />
3.å®è¾¹ä¼šåŒ…å«åœ¨Splayä¸­ï¼Œè™šè¾¹æ€»æ˜¯ç”±ä¸€æ£µSplayæŒ‡å‘å®ƒä¸­åºéå†æœ€é å‰çš„ç‚¹åœ¨åŸæ ‘é‡Œçš„çˆ¶äº²ã€‚</p>
<p>é‚£ä¹ˆä¸ºäº†ä¿æŒæ ‘çš„å½¢æ€ï¼Œæˆ‘ä»¬è¦è®©çˆ¶èŠ‚ç‚¹æŒ‡å‘å…¶å®ƒå­èŠ‚ç‚¹çš„è¾¹ä¸ºè™šè¾¹ï¼Œä½†æ˜¯å…¶å®ƒå­èŠ‚ç‚¹ä¼šæŒ‡å‘çˆ¶èŠ‚ç‚¹ï¼Œå³è®¤çˆ¶ä¸è®¤å­ã€‚</p>
<p>å„ç§æ“ä½œï¼š</p>
<h4 id="accessx"><a class="markdownIt-Anchor" href="#accessx"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">access(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></h4>
<p>ä¸ºLCTæ ¸å¿ƒæ“ä½œï¼Œç”¨æ¥å˜æ¢è™šå®è¾¹ã€‚</p>
<p>ç”±äºå…¶æ€§è´¨3,æˆ‘ä»¬å¹¶ä¸èƒ½ä¿è¯ä¸¤ä¸ªç‚¹è·¯å¾„ä¼šç›´æ¥è¿é€šã€‚é‚£ä¹ˆæˆ‘ä»¬æ­¤æ—¶å°±éœ€è¦ä¸€ä¸ªæ“ä½œæ¥æ‰“é€šæ ‘çš„ä»»é€šäºŒè„‰ï¼Œè®©æˆ‘ä»¬æŒ‡å®šçš„èŠ‚ç‚¹ä¹‹é—´å­˜åœ¨ä¸€æ¡é€šè·¯ã€‚</p>
<p>é‚£ä¹ˆ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">access</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span>å°±åº”è¿è€Œç”Ÿäº†ï¼Œå®ƒå®šä¹‰ä¸ºæ‰“é€šæ ¹ç»“ç‚¹åˆ°æŒ‡å®šèŠ‚ç‚¹çš„å®é“¾ï¼Œä½¿ä¸€ä¸ªä¸­åºéå†ä»æ ¹ç»“ç‚¹å¼€å§‹ï¼Œåˆ°æŒ‡å®šèŠ‚ç‚¹åœæ­¢çš„Spalyè¢«æ„é€ ã€‚</p>
<p>æˆ‘ä»¬æ”¾å‡ ä¸ªå›¾ï¼ˆå·å¾—ï¼š</p>
<p><img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123095924037-1618037447.png" alt="" /></p>
<p>è¿™æ˜¯æ ‘çš„å¼€å§‹çŠ¶æ€ï¼Œæˆ‘ä»¬ç»™ä»–åˆ’åˆ†ä¸€ä¸‹Splayï¼š</p>
<p><img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123095955350-1680422636.png" alt="" /></p>
<p>å‡è®¾æˆ‘ä»¬éœ€è¦æŠŠ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>åˆ°<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex">A</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">A</span></span></span></span>æ‰“é€šï¼Œé‚£ä¹ˆå…¶ä»–çš„é“¾éƒ½è¦ç»™å®ƒè®©è·¯ï¼Œä¹Ÿå°±æ˜¯å˜æˆä¸‹å›¾ï¼š</p>
<p><img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123101901740-2118178734.png" alt="" /></p>
<p>å¦‚ä½•å®ç°ï¼Ÿæ¨¡æ‹Ÿå³å¯ã€‚</p>
<p>é¦–å…ˆæŠŠ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>å˜æˆæ ¹ï¼Œå†æŠŠåŸæ¥<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi><mo>âˆ’</mo><mi>O</mi></mrow><annotation encoding="application/x-tex">N-O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span>çš„è¾¹å˜ä¸ºè™šè¾¹ã€‚åˆä¸ºäº†ä¿è¯æ·±åº¦ä¸¥æ ¼å•è°ƒï¼Œæˆ‘åœ¨Splayä¸­<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>O</mi></mrow><annotation encoding="application/x-tex">O</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">O</span></span></span></span>åœ¨<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>çš„å³å­æ ‘é‡Œï¼Œé‚£ä¹ˆç›´æ¥æŠŠ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span>çš„å³å­èŠ‚ç‚¹å˜ä¸º0ï¼š<br />
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110136115-1112016464.png" alt="" /></p>
<p>ä¹‹åå†æŠŠå…¶ä»–ç¢äº‹çš„ç©æ„éƒ½å¹²æ‰å°±è¡Œ<br />
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110156272-1242463729.png" alt="" /><br />
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110209772-2057141058.png" alt="" /><br />
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110213709-49169640.png" alt="" /><br />
å¥½äº†ï¼ŒæˆåŠŸäº†ã€‚</p>
<p>ä»£ç å®ç°ä¹Ÿä¸éš¾ï¼Œåªéœ€è¦è½¬åˆ°æ ¹ï¼Œæ¢å­èŠ‚ç‚¹ï¼Œæ›´æ–°ï¼Œå†æŠŠå½“å‰ç‚¹åˆ‡æ¢ä¸ºè™šè¾¹æŒ‡å‘çš„çˆ¶èŠ‚ç‚¹å³å¯ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">access</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> v=<span class="hljs-number">0</span>;x;v=x,x=f[x])<br>		<span class="hljs-built_in">splay</span>(x),<span class="hljs-built_in">rs</span>(x)=v,<span class="hljs-built_in">up</span>(x);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="makerootx"><a class="markdownIt-Anchor" href="#makerootx"></a> <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">makeroot(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mord mathdefault">e</span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="mord mathdefault">o</span><span class="mord mathdefault">o</span><span class="mord mathdefault">t</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span></h4>
<p>ä»…ä»…æŠŠæŸæ¡è·¯å¾„æ‹‰èµ·æ¥å¹¶ä¸èƒ½å®ç°æˆ‘ä»¬çš„éœ€æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å¾—åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·¯å¾„ä¿¡æ¯ã€‚</p>
<p>ç„¶è€Œè¿™ä¿©ç‚¹ä¸ä¸€å®šæ˜¯åŒä¸€é“¾ä¸Šï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ¢æ ¹ï¼Œä½¿æŒ‡å®šçš„èŠ‚ç‚¹æˆä¸ºåŸæ ‘çš„æ ¹ï¼Œå°±å¯ä»¥å¿«é€Ÿåœ°åˆ©ç”¨æ€§è´¨å¤„ç†äº†ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å€ŸåŠ©ä¸€ä¸‹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">access(x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span> å’ŒSplayçš„ç¿»è½¬çš„æ“ä½œæ¥å®ç°ã€‚</p>
<p>æ‰“é€šé“è·¯å<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>ä¸€å®šæ˜¯Splayä¸­ä¸­åºéå†çš„æœ€åä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆæˆ‘ä»¬è½¬ä¸Šå»åï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>åœ¨Splayé‡Œä¼šæ²¡æœ‰å³å­æ ‘ã€‚é‚£ä¹ˆæˆ‘ä»¬ç¿»è½¬æ•´ä¸ªSplayï¼Œä½¿å¾—æ‰€æœ‰ç‚¹çš„æ·±åº¦ä¹Ÿç¿»è½¬ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>æ²¡äº†å·¦å­æ ‘ï¼Œå°±ä¼šå˜æˆæ·±åº¦æœ€å°çš„ç‚¹ï¼Œå³æ ¹ç»“ç‚¹ï¼Œé‚£ä¹ˆå°±å®ç°äº†æ¢æ ¹çš„æ“ä½œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">reverse</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">swap</span>(<span class="hljs-built_in">ls</span>(x),<span class="hljs-built_in">rs</span>(x));<br>    tagr[x]^=<span class="hljs-number">1</span>;<span class="hljs-comment">//ç¿»è½¬çš„LazyTag</span><br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">makeroot</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">access</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-built_in">reverse</span>(x);<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="findroot"><a class="markdownIt-Anchor" href="#findroot"></a> findroot</h4>
<p>å³æ‰¾æŸç‚¹æ‰€åœ¨æ ‘çš„æ ¹ï¼Œä¸»è¦ç”¨äºåˆ¤æ–­ä¸¤ç‚¹æ˜¯å¦è¿é€šã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">findroot</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">access</span>(x); <br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-keyword">while</span>(<span class="hljs-built_in">ls</span>(x))<span class="hljs-built_in">down</span>(x),x=<span class="hljs-built_in">ls</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-keyword">return</span> x;<br>&#125;<br></code></pre></td></tr></table></figure>
<h4 id="split"><a class="markdownIt-Anchor" href="#split"></a> split</h4>
<p>å®šä¹‰ä¸ºä» <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>âˆ’</mo><mo>&gt;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x-&gt;y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> æ‹‰å‡ºä¸€æ¡è·¯å¾„æˆä¸ºä¸€ä¸ªSplayã€‚(è¿™é‡Œè®© <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ä½œä¸ºSplayçš„æ ¹ï¼Œ<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span> ä½œä¸ºåŸæ ‘çš„æ ¹)</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">makeroot</span>(x);<br>    <span class="hljs-built_in">access</span>(y);<br>    <span class="hljs-built_in">splay</span>(y);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆè·¯å¾„å°±å¯ä»¥ç›´æ¥ç”¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi></mrow><annotation encoding="application/x-tex">access</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span></span></span></span> å¾—åˆ°ï¼Œè€ŒæŠŠ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> è½¬åˆ°Splayæ ¹ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è®¿é—®å®ƒæ¥è·å¾—æœ‰å…³ä¿¡æ¯ã€‚</p>
<h4 id="link"><a class="markdownIt-Anchor" href="#link"></a> link</h4>
<p>è¿è¾¹ï¼ˆä½¿<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>âˆ’</mo><mo>&gt;</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x-&gt;y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">x</span><span class="mord">âˆ’</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œè™šè¾¹ï¼‰</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">makeroot</span>(x);<br>    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">findroot</span>(y)==x)<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>    f[x]=y;<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>è¿™é‡Œå¸ƒå°”è¿”å›å€¼æ˜¯åˆ¤æ–­è¿è¾¹æ˜¯å¦åˆæ³•ã€‚</p>
<h4 id="cut"><a class="markdownIt-Anchor" href="#cut"></a> cut</h4>
<p>æ–­è¾¹ã€‚</p>
<p>å¦‚æœä¿è¯åˆæ³•ï¼Œå¦‚ä¸‹</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">split</span>(x,y);<br>    f[x]=<span class="hljs-built_in">ls</span>(y)=<span class="hljs-number">0</span>;<br>    <span class="hljs-built_in">up</span>(y);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>å¦‚æœä¸ä¿è¯ï¼Œæˆ‘ä»¬ä¼šåˆ©ç”¨æ€§è´¨ï¼š</p>
<p>å…ˆåˆ¤æ–­è¿é€šæ€§(<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi></mrow><annotation encoding="application/x-tex">x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">x</span></span></span></span>å˜æˆæ ¹äº†)ï¼Œå†çœ‹æ˜¯å¦æœ‰çˆ¶å­å…³ç³»ï¼Œå†çœ‹ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span>æ˜¯å¦æœ‰å·¦å­èŠ‚ç‚¹ã€‚</p>
<p>å› ä¸ºåœ¨ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">access(y)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">a</span><span class="mord mathdefault">c</span><span class="mord mathdefault">c</span><span class="mord mathdefault">e</span><span class="mord mathdefault">s</span><span class="mord mathdefault">s</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mclose">)</span></span></span></span> ä¹‹åï¼Œå¦‚æœä¸¤ç‚¹åœ¨åŒä¸€Splayä½†æ˜¯æ²¡æœ‰ç›´æ¥çš„è¾¹ï¼Œé‚£ä¹ˆä¸­é—´ä¼šæœ‰åˆ«çš„è¾¹ï¼Œä¸”ä¸­åºéå†æ—¶ <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">x,y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span></span></span></span> ç›´æ¥ä¼šæœ‰åˆ«çš„è¾¹ã€‚</p>
<p>æ‰€ä»¥éœ€è¦æ»¡è¶³ä¸‰ä¸ªæ¡ä»¶æ‰å¯æ–­ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-type">int</span> x,<span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>	<span class="hljs-built_in">makeroot</span>(x);<br>	<span class="hljs-keyword">if</span>(<span class="hljs-built_in">findroot</span>(y)!=x||f[y]!=x||<span class="hljs-built_in">ls</span>(y))<br>        <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>	f[y]=<span class="hljs-built_in">rs</span>(x)=<span class="hljs-number">0</span>;<span class="hljs-comment">//xåœ¨findroot(y)åè¢«è½¬åˆ°äº†æ ¹</span><br>	<span class="hljs-built_in">up</span>(x);<br>	<span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
<p>é‚£ä¹ˆLCTä¸­çš„Splayæ“ä½œä¹Ÿä¼šæœ‰äº›ç»†èŠ‚ä¸å¤§å¯»å¸¸ï¼Œå¯ä»¥ç”¨ä¸‹é¢æ›´ç¨³å¦¥çš„æ–¹æ³•å†™ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span>(tagr[x])<br>    &#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">ls</span>(x))<br>            <span class="hljs-built_in">resver</span>(<span class="hljs-built_in">ls</span>(x));<br>        <span class="hljs-keyword">if</span>(<span class="hljs-built_in">rs</span>(x))<br>            <span class="hljs-built_in">resver</span>(<span class="hljs-built_in">rs</span>(x));<br>        tagr[x]=<span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">makeroot</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">access</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-built_in">pushr</span>(x);<br>&#125;<br></code></pre></td></tr></table></figure>
<p>åŸºç¡€æ“ä½œæ²¡äº†ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;bits/stdc++.h&gt;</span></span><br><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> std;<br><span class="hljs-meta">#<span class="hljs-keyword">ifdef</span> ONLINE_JUDGE</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> getchar() (p1 == p2 &amp;&amp; (p2 = (p1 = buf) + fread(buf, 1, 1 &lt;&lt; 21, stdin), p1 == p2) ? EOF : *p1++)</span><br><span class="hljs-type">char</span> buf[<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">21</span>], *p1 = buf, *p2 = buf;<br><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">read</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> ret = <span class="hljs-number">0</span>, flag = <span class="hljs-number">1</span>;<br>    <span class="hljs-type">char</span> c = <span class="hljs-built_in">getchar</span>();<br>    <span class="hljs-keyword">while</span> (c &lt; <span class="hljs-string">&#x27;0&#x27;</span> || c &gt; <span class="hljs-string">&#x27;9&#x27;</span>)<br>    &#123;<br>        <span class="hljs-keyword">if</span> (c == <span class="hljs-string">&#x27;-&#x27;</span>)<br>            flag = <span class="hljs-number">-1</span>;<br>        c = <span class="hljs-built_in">getchar</span>();<br>    &#125;<br>    <span class="hljs-keyword">while</span> (c &gt;= <span class="hljs-string">&#x27;0&#x27;</span> &amp;&amp; c &lt;= <span class="hljs-string">&#x27;9&#x27;</span>)<br>        ret = ret * <span class="hljs-number">10</span> + c - <span class="hljs-string">&#x27;0&#x27;</span>, c = <span class="hljs-built_in">getchar</span>();<br>    <span class="hljs-keyword">return</span> ret * flag;<br>&#125;<br><span class="hljs-type">const</span> <span class="hljs-type">int</span> Maxn = <span class="hljs-number">3e5</span> + <span class="hljs-number">10</span>;<br><span class="hljs-meta">#<span class="hljs-keyword">define</span> ls(x) son[x][0]</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> rs(x) son[x][1]</span><br><span class="hljs-type">int</span> n, m;<br><span class="hljs-type">int</span> rt;<br><span class="hljs-type">int</span> son[Maxn][<span class="hljs-number">2</span>];<br><span class="hljs-type">int</span> f[Maxn], val[Maxn];<br><span class="hljs-type">int</span> s[Maxn], st[Maxn];<br><span class="hljs-type">int</span> v[Maxn];<br><span class="hljs-type">bool</span> r[Maxn];<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">bool</span> <span class="hljs-title">nrt</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">ls</span>(f[x]) == x <span class="hljs-keyword">or</span> <span class="hljs-built_in">rs</span>(f[x]) == x;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">up</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    s[x] = s[<span class="hljs-built_in">ls</span>(x)] ^ s[<span class="hljs-built_in">rs</span>(x)] ^ v[x];<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">rev</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">swap</span>(<span class="hljs-built_in">ls</span>(x), <span class="hljs-built_in">rs</span>(x));<br>    r[x] ^= <span class="hljs-number">1</span>;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">down</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">if</span> (r[x])<br>    &#123;<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">ls</span>(x))<br>            <span class="hljs-built_in">rev</span>(<span class="hljs-built_in">ls</span>(x));<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">rs</span>(x))<br>            <span class="hljs-built_in">rev</span>(<span class="hljs-built_in">rs</span>(x));<br>        r[x] = <span class="hljs-number">0</span>;<br>    &#125;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">rotate</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> y = f[x], z = f[y];<br>    <span class="hljs-type">int</span> k = (<span class="hljs-built_in">rs</span>(y) == x), w = son[x][!k];<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">nrt</span>(y))<br>        son[z][<span class="hljs-built_in">rs</span>(z) == y] = x;<br>    son[x][!k] = y;<br>    son[y][k] = w;<br>    <span class="hljs-keyword">if</span> (w)<br>        f[w] = y;<br>    f[y] = x, f[x] = z;<br>    <span class="hljs-built_in">up</span>(y);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">splay</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-type">int</span> y = x, t = <span class="hljs-number">0</span>;<br>    st[++t] = y;<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">nrt</span>(y))<br>        st[++t] = y = f[y];<br>    <span class="hljs-keyword">while</span> (t)<br>        <span class="hljs-built_in">down</span>(st[t--]);<br><br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">nrt</span>(x))<br>    &#123;<br>        y = f[x];<br>        t = f[y];<br>        <span class="hljs-keyword">if</span> (<span class="hljs-built_in">nrt</span>(y))<br>            <span class="hljs-built_in">rotate</span>((<span class="hljs-built_in">ls</span>(y) == x) ^ ((<span class="hljs-built_in">ls</span>(t) == y)) ? x : y);<br>        <span class="hljs-built_in">rotate</span>(x);<br>    &#125;<br>    <span class="hljs-built_in">up</span>(x);<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">access</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">register</span> <span class="hljs-type">int</span> y = <span class="hljs-number">0</span>; x; x = f[y = x])<br>    &#123;<br>        <span class="hljs-built_in">splay</span>(x), <span class="hljs-built_in">rs</span>(x) = y;<br>        <span class="hljs-built_in">up</span>(x);<br>    &#125;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">makert</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">access</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-built_in">rev</span>(x);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">int</span> <span class="hljs-title">findrt</span><span class="hljs-params">(<span class="hljs-type">int</span> x)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">access</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-keyword">while</span> (<span class="hljs-built_in">ls</span>(x))<br>        <span class="hljs-built_in">down</span>(x), x = <span class="hljs-built_in">ls</span>(x);<br>    <span class="hljs-built_in">splay</span>(x);<br>    <span class="hljs-keyword">return</span> x;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">makert</span>(x);<br>    <span class="hljs-built_in">access</span>(y);<br>    <span class="hljs-built_in">splay</span>(y);<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">makert</span>(x);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">findrt</span>(y) != x)<br>        f[x] = y;<br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-type">int</span> x, <span class="hljs-type">int</span> y)</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">makert</span>(x);<br>    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">findrt</span>(y) == x <span class="hljs-keyword">and</span> f[y] == x <span class="hljs-keyword">and</span> !<span class="hljs-built_in">ls</span>(y))<br>    &#123;<br>        f[y] = <span class="hljs-built_in">rs</span>(x) = <span class="hljs-number">0</span>;<br>        <span class="hljs-built_in">up</span>(x);<br>    &#125;<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-type">void</span> <span class="hljs-title">work</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    n = <span class="hljs-built_in">read</span>();<br>    m = <span class="hljs-built_in">read</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">register</span> <span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= n; i++)<br>        v[i] = <span class="hljs-built_in">read</span>();<br>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">register</span> <span class="hljs-type">int</span> i = <span class="hljs-number">1</span>; i &lt;= m; i++)<br>    &#123;<br>        <span class="hljs-type">int</span> opt = <span class="hljs-built_in">read</span>();<br>        <span class="hljs-type">int</span> x = <span class="hljs-built_in">read</span>(), y = <span class="hljs-built_in">read</span>();<br>        <span class="hljs-keyword">if</span> (opt == <span class="hljs-number">0</span>)<br>            <span class="hljs-built_in">split</span>(x, y), <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%d\n&quot;</span>, s[y]);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opt == <span class="hljs-number">1</span>)<br>            <span class="hljs-built_in">link</span>(x, y);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opt == <span class="hljs-number">2</span>)<br>            <span class="hljs-built_in">cut</span>(x, y);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opt == <span class="hljs-number">3</span>)<br>            <span class="hljs-built_in">splay</span>(x), v[x] = y;<br>    &#125;<br><br>    <span class="hljs-keyword">return</span>;<br>&#125;<br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-built_in">work</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>
      </section>

      
      
        <nav class="article-nav">
          
          
            <div class="article-nav-item layout-padding">
  <article class="card-container article-nav-card content-padding--primary soft-size--large soft-style--box">
    
      <div class="card-cover" background-image-lazy data-img="https://cdn.luogu.com.cn/upload/image_hosting/2ftetr9n.png"></div>
    
    <div class="card-text">
      
        <a href="/2022/07/22/Min25%E7%AD%9B/" itemprop="url">
          <h2 class="card-text--title text-ellipsis">Min25ç­›</h2>
        </a>
      
      <div class="card-text--row">Older</div>
    </div>
  </article>
</div>
          
        </nav>
      

      <section class="page-message-container layout-padding">
        


  
  

  
  


      </section>
    </div>
    <div class="widget-info">
      <section class="widget-author widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-body">
    
      <img src="https://cdn.luogu.com.cn/upload/image_hosting/vj8obimb.png" class="soft-size--round soft-style--box" alt="Ztemily">
    
    
      <h2>Ztemily</h2>
    
    
      <p>æ­¤åå¦‚ç«Ÿæ²¡æœ‰ç‚¬ç«ï¼Œæˆ‘ä»¬ä¾¿æ˜¯å”¯ä¸€çš„å…‰ã€‚</p>
    

    <div class="count-box">
      <div class="count-box--item">
        <svg class="icon icon-article" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M240.51564747 647.74217627h196.07203239c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806V165.10332731c0-33.18142087-30.16492806-60.32985613-60.32985612-60.32985611H245.04038668C225.43318342 104.7734712 210.35071939 119.85593522 210.35071939 139.46313845V617.57724821c0 16.59071043 13.57421762 30.16492806 30.16492808 30.16492806z m663.62841731-452.47392089v482.63884894c0 33.18142087-27.14843525 60.32985613-60.32985612 60.32985613H180.18579134c-33.18142087 0-60.32985613-27.14843525-60.32985612-60.32985613V195.26825538c-49.77213131 0-90.49478418 40.72265287-90.49478417 90.49478417v452.4739209c0 49.77213131 40.72265287 90.49478418 90.49478417 90.49478417h286.56681657c16.59071043 0 30.16492806 13.57421762 30.16492807 30.16492807s13.57421762 30.16492806 30.16492805 30.16492806h90.49478418c16.59071043 0 30.16492806-13.57421762 30.16492805-30.16492806s13.57421762-30.16492806 30.16492807-30.16492807h286.56681657c49.77213131 0 90.49478418-40.72265287 90.49478417-90.49478417V285.76303955c0-49.77213131-40.72265287-90.49478418-90.49478417-90.49478417zM587.41232014 647.74217627h191.54729318c19.60720323 0 34.68966726-15.08246403 34.68966729-34.68966727V134.93839925c0-16.59071043-13.57421762-30.16492806-30.16492808-30.16492805H617.57724821c-30.16492806 0-60.32985613 27.14843525-60.32985612 60.32985611v452.4739209c0 16.59071043 13.57421762 30.16492806 30.16492805 30.16492806z" fill="currentColor"></path>
</svg>
        <span>5</span>
      </div>
      <div class="count-box--item">
        <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
        0
      </div>
      <div class="count-box--item">
        <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
        1
      </div>
    </div>
  </div>
</section>

      

      
<section class="widet-notice widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-notice" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M512 945.02305225v28.15620663a24.27259221 24.27259221 0 0 1-24.27259221 24.27259335H394.0352a48.54518557 48.54518557 0 0 1-41.74885888-23.78714112l-110.68302222-184.47170332a132.04290333 132.04290333 0 0 1-17.47626667-48.54518557h118.4502511a200.97706667 200.97706667 0 0 1 76.21594113 14.56355556l20.38897777 133.49925888a48.54518557 48.54518557 0 0 0 36.40888888 27.67075555l16.01991111 2.91271112a24.27259221 24.27259221 0 0 1 20.38897778 25.72894889zM997.45185223 463.45481443a194.18074112 194.18074112 0 0 1-38.8361489 116.50844445 24.75804445 24.75804445 0 0 1-36.4088889 0l-34.95253333-34.95253333a24.27259221 24.27259221 0 0 1-2.91271111-30.58346667 97.09036999 97.09036999 0 0 0 0-106.79940665 24.27259221 24.27259221 0 0 1 2.91271111-30.58346666l34.95253333-34.95253334a24.75804445 24.75804445 0 0 1 18.93262223-7.28177777 26.2144 26.2144 0 0 1 17.47626667 9.70903665A194.18074112 194.18074112 0 0 1 997.45185223 463.45481443z m-194.18074112-388.36148111v776.72296335a48.54518557 48.54518557 0 0 1-48.54518556 48.54518443h-28.64165888a48.54518557 48.54518557 0 0 1-33.98163001-14.07810332l-145.63555556-143.20829668A291.27111111 291.27111111 0 0 0 342.57730333 657.63555556H172.18370333a145.63555556 145.63555556 0 0 1-145.63555556-145.63555556v-97.09036999a145.63555556 145.63555556 0 0 1 145.63555556-145.63555556h170.3936a291.27111111 291.27111111 0 0 0 206.31703779-85.43952668l145.63555555-143.20829554a48.54518557 48.54518557 0 0 1 33.98162888-14.07810446H754.72592555a48.54518557 48.54518557 0 0 1 48.54518556 48.54518555z" fill="currentColor"></path>
</svg>
    <span>NOTICE</span>
  </div>
  <div class="widget-body">
    <p>æ–°æ­å»ºçš„åšå®¢ï¼Œæ¬¢è¿æ¥ç©~</p>
  </div>
</section>


      <section class="widget-categorys widget-item layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-categories" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M900.3614811 257.09082106h-339.81629553l-67.96326003-101.9448889c-19.41807444-29.12711113-48.54518557-43.69066667-82.52681443-43.69066667H123.6385189c-53.39970333 0-97.09036999 43.69066667-97.09037113 97.09036999v582.54222222c0 53.39970333 43.69066667 97.09036999 97.09037113 97.09037002h776.7229622c53.39970333 0 97.09036999-43.69066667 97.09037113-97.09037002V354.18119104c0-53.39970333-43.69066667-97.09036999-97.09037113-97.09036998z m-97.09036999 242.72592554H220.72888889c-24.27259221 0-48.54518557-24.27259221-48.54518556-48.54518556s24.27259221-48.54518557 48.54518556-48.54518444h582.54222222c24.27259221 0 48.54518557 24.27259221 48.54518556 48.54518444s-24.27259221 48.54518557-48.54518556 48.54518556z" fill="currentColor"></path>
</svg>
    <span>CATEGORYS</span>
  </div>
  <div class="widget-body">
    <ul class="categorys-list">
      
    </ul>
  </div>
</section>

      <section class="widget-tags widget-item  layout-margin content-padding--primary soft-size--large soft-style--box">
  <div class="widget-title">
    <svg class="icon icon-tags" viewBox="0 0 1098 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M283.42180005 272q0-28.38857157-20.09142843-48.48000001t-48.47999998-20.09142842-48.48000002 20.09142842-20.09142846 48.48000001 20.09142846 48.48 48.48000002 20.09142843 48.47999998-20.09142843 20.09142843-48.48zM855.0332285 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.03999997 263.58857157q-20.9142853 19.81714313-48.75428534 19.81714312-28.38857157 0-48.20571468-19.81714312l-383.04-383.58857157q-20.36571468-19.81714313-34.55999999-54.10285688t-14.19428534-62.6742853l0-222.85714313q0-27.84000002 20.36571469-48.20571469t48.2057147-20.36571466l222.85714313 0q28.38857157 0 62.6742853 14.19428529t54.65142842 34.55999999l383.04000001 382.49142843q19.81714313 20.9142853 19.81714314 48.75428532zM1060.74751475 580.57142843q0 28.38857157-19.81714313 48.2057147l-263.04 263.58857157q-20.9142853 19.81714313-48.75428531 19.81714312-19.26857155 0-31.61142843-7.47428531t-28.38857159-24.13714314l251.79428534-251.7942853q19.81714313-19.81714313 19.81714308-48.20571469 0-27.84000002-19.81714308-48.75428531l-383.04000001-382.49142845q-20.36571468-20.36571468-54.65142842-34.55999999t-62.67428532-14.19428534l120 0q28.38857157 0 62.67428532 14.19428534t54.65142842 34.55999999l383.03999998 382.49142845q19.81714313 20.9142853 19.81714314 48.75428531z" fill="currentColor"></path>
</svg>
    <span>TAGS</span>
  </div>
  <div class="widget-body">
    <div class="tags-cloud">
      <a href="/tags/OI/" style="font-size: 10px;" class="tags-cloud-0">OI</a>
    </div>
  </div>
</section>
    </div>
  </article>
</div>

    <!-- footer container -->
<footer id="footer" class="footer">
  <div class="footer-container">
    
    <div class="social-icons">
      
        
      
        
      
        
      
        
          <a href="https://github.com/ztemil/" class="soft-size--primary soft-style--box" target="_blank" rel="noopener noreferrer">
            <svg class="icon icon-github" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
  <path d="M64.6 512c0 195.6 125.4 361.9 300.1 422.9 23.5 5.9 19.9-10.8 19.9-22.2v-77.6c-135.8 15.9-141.3-74-150.5-89-18.5-31.5-61.9-39.5-49-54.5 31-15.9 62.5 4 98.9 58 26.4 39.1 77.9 32.5 104.1 26 5.7-23.5 17.9-44.5 34.7-60.9-140.7-25.2-199.4-111.1-199.4-213.3 0-49.5 16.4-95.1 48.4-131.8-20.4-60.6 1.9-112.4 4.9-120.1 58.2-5.2 118.5 41.6 123.3 45.3 33.1-8.9 70.8-13.7 112.9-13.7 42.4 0 80.3 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.4-43.9 2.9 7.7 24.7 58.3 5.5 118.1 32.5 36.8 49 82.8 49 132.4 0 102.3-59 188.3-200.2 213.2 23.5 23.3 38.1 55.5 38.1 91.1v112.7c0.8 9 0 17.9 15.1 17.9C832.7 877 960.4 709.4 960.4 512.1c0-247.5-200.6-447.9-447.9-447.9C265 64.1 64.6 264.5 64.6 512z"></path>
</svg>
          </a>
        
      
        
      
    </div>
     
    <p>&copy; 2022 <a href="/" target="_blank">Ztemily</a></p>

    

    <p>Powered by <a href="https://hexo.io" target="_blank" rel="noopener noreferrer">Hexo</a> Theme - <a href="https://github.com/miiiku/flex-block" target="_blank" rel="noopener noreferrer author">flex-block</a></p>

    <p>
      <a href="javascript:;" id="theme-light">ğŸŒ æµ…è‰²</a>
      <a href="javascript:;" id="theme-dark">ğŸŒ› æ·±è‰²</a>
      <a href="javascript:;" id="theme-auto">ğŸ¤–ï¸ è‡ªåŠ¨</a>
    </p>
  </div>
</footer>
  </div>

  <div class="back-to-top-fixed soft-size--round soft-style--box">
    <svg class="icon icon-back-to-top" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg">
      <path d="M725.333333 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8l-213.333333-213.333333c-17.066667-17.066667-17.066667-42.666667 0-59.733333s42.666667-17.066667 59.733333 0l213.333333 213.333333c17.066667 17.066667 17.066667 42.666667 0 59.733333C746.666667 422.4 738.133333 426.666667 725.333333 426.666667z"></path>
      <path d="M298.666667 426.666667c-12.8 0-21.333333-4.266667-29.866667-12.8-17.066667-17.066667-17.066667-42.666667 0-59.733333l213.333333-213.333333c17.066667-17.066667 42.666667-17.066667 59.733333 0s17.066667 42.666667 0 59.733333l-213.333333 213.333333C320 422.4 311.466667 426.666667 298.666667 426.666667z"></path>
      <path d="M512 896c-25.6 0-42.666667-17.066667-42.666667-42.666667L469.333333 170.666667c0-25.6 17.066667-42.666667 42.666667-42.666667s42.666667 17.066667 42.666667 42.666667l0 682.666667C554.666667 878.933333 537.6 896 512 896z"></path>
    </svg>
  </div>

  
  <!-- aplayer -->


<!-- dplayer -->




  


  


  




<script src="/js/script.js"></script>


  
  <!-- å°¾éƒ¨ç”¨æˆ·è‡ªå®šä¹‰ç›¸å…³å†…å®¹ -->
</body>
</html>
